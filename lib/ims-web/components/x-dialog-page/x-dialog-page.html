<dom-module id="x-dialog-page">
    <link rel="stylesheet" href="x-dialog-page.css">
    <template>
        <iron-ajax id="getMessagesRequest"
                   url$="{{serviceMessagesUrl}}"
                   method="GET"
                   handle-as="json"
                   last-response="{{messages}}"
                   with-credentials="true">
        </iron-ajax>

        <div id="message-box">
                <ul class="comment-section">
                    <template is="dom-repeat" items="{{messages}}" as="message">
                        <li class$="[[getMessageClass(message.sender)]]">

                            <div class="info">
                                <a href="#">{{message.author_firstname}}</a>
                                <span>{{formatTime(message.created_at)}}</span>
                            </div>

                            <a class="avatar" href="#">
                                <img src$="/profile/[[message.author_avatar]]" width="35" alt="Profile Avatar" />
                            </a>

                            <p>{{message.body}}</p>

                        </li>
                    </template>
                    <li class="write-new">

                        <form action="" method="post" on-submit="sendMessage">
                            <textarea placeholder="Write your message here" name="comment" value="{{outbox_message::input}}"></textarea>
                            <div>
                                <img src$="/profile/{{user.avatar}}" width="35" alt="Profile Img" />
                                <button type="submit">Submit</button>
                            </div>
                        </form>
                    </li>
                </ul>
        </div>
    </template>

    <script src="/socket.io/socket.io.js"></script>
    <script src="x-dialog-page.js"></script>

</dom-module>