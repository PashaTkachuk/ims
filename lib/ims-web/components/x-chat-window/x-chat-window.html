<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">

<dom-module id="x-chat-window">
    <link rel="stylesheet" href="x-chat-window.css">
    <template>
        <iron-ajax auto
                   url="http://localhost:3000/message/2"
                   method="GET"
                   handle-as="json"
                   last-response="{{messages}}"
                   with-credentials="true">
        </iron-ajax>

        <div id="message-box">
                <ul class="comment-section">
                    <template is="dom-repeat" items="{{messages}}" as="message">
                        <li class$="[[getMessageClass(message.sender)]]">

                            <div class="info">
                                <a href="#">{{message.author_firstname}}</a>
                                <span>{{formatTime(message.created_at)}}</span>
                            </div>

                            <a class="avatar" href="#">
                                <img src$="/profile/[[message.author_avatar]]" width="35" alt="Profile Avatar" />
                            </a>

                            <p>{{message.body}}</p>

                        </li>
                    </template>
                    <li class="write-new">

                        <form action="" method="post" on-submit="sendMessage">
                            <textarea placeholder="Write your message here" name="comment" value="{{outbox_message::input}}"></textarea>
                            <div>
                                <img src$="/profile/[[user_avatar]]" width="35" alt="Profile Img" />
                                <button type="submit">Submit</button>
                            </div>
                        </form>
                    </li>
                </ul>
        </div>
    </template>

    <script src="/socket.io/socket.io.js"></script>
    <script src="x-chat-window.js"></script>

</dom-module>